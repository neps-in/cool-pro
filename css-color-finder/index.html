<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CSS Color Map Viewer | PutForShare Open Source Initiative </title>
  <style>
    /* Remove ALL white space from the page edges */
    html, body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background: #f5f5f5;
    }

    h1 {
      font-size: 24px;
      margin-bottom: 16px;
    }

    /* === Full width brand header === */
    /* header {
      width: 100%;
      background: #6c590e;
      color: white;
      display: flex;
      align-items: center;
      gap: 20px;
      padding: 12px 30px;
      box-sizing: border-box;
    } */
    
    header {
      width: 100%;
      background: #6c590e;
      color: white;
      display: flex;
      justify-content: space-between; /* New: space items left & right */
      align-items: center;
      gap: 20px;
      padding: 12px 30px;
      box-sizing: border-box;
    }
    
    .back-btn {
      margin-left: auto;
      background: #ffffff22;
      color: #fff;
      text-decoration: none;
      padding: 6px 14px;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 600;
      border: 1px solid #ffffff55;
      transition: 0.3s ease;
    }
    
    .back-btn:hover {
      background: #ffffff44;
      border-color: white;
    }
    
    header img {
      height: 48px;
      width: 48px;
      border-radius: 8px;
      object-fit: cover;
      background: #fff;
      padding: 4px;
    }
  
    header .brand-title {
      font-size: 22px;
      font-weight: bold;
    }
  
    header .brand-tagline {
      font-size: 14px;
      opacity: 0.9;
      margin-top: -2px;
    }
  
    .brand-text {
      display: flex;
      flex-direction: column;
    }

    /* intro hero block */
    .color-map-card {
      margin: 20px 0;
      padding: 20px;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      border: 1px solid rgba(0,0,0,0.05);
      font-family: system-ui, Arial, sans-serif;
    }
    
    .color-map-card h2 {
      margin-top: 0;
      color: #333;
      font-size: 1.3rem;
      font-weight: 600;
    }
    
    .color-map-card p {
      margin: 10px 0;
      font-size: 0.95rem;
      line-height: 1.6;
      color: #555;
    }
    /* intro hero block ends */

    
    /* === Equal left & right margin for entire content area === */
    #content-wrapper {
      max-width: 1200px;
      margin: 0 auto; /* Equal L/R margins */
      padding: 20px;
    }
  
    #controls {
      max-width: 1200px;
      margin: 0 auto 20px auto;
    }

    #css-input {
      width: 100%;
      box-sizing: border-box;
      font-family: monospace;
      font-size: 13px;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      min-height: 200px;
      resize: vertical;
    }

    #render-btn {
      margin-top: 10px;
      padding: 6px 12px;
      border-radius: 6px;
      border: 1px solid #007bff;
      background: #007bff;
      color: #fff;
      font-size: 14px;
      cursor: pointer;
    }

    #render-btn:hover {
      background: #0069d9;
    }

    #clear-btn {
      background: #ff4d4d;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 14px;
      color: #fff;
      margin-left: 8px;
      cursor: pointer;
      transition: 0.2s ease;
    }
    
    #clear-btn:hover {
      background: #e60000;
    }
    
    .selector-block {
      margin-bottom: 24px;
      padding: 16px;
      background: #ffffff;
      border-radius: 10px;
      border: 1px solid #ddd;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }

    .selector-title {
      font-weight: bold;
      margin-bottom: 12px;
      font-family: monospace;
    }

    .cards-container {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
    }

    .color-card {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      width: 210px;
      padding: 10px;
      background: #fafafa;
      border-radius: 10px;
      border: 1px solid #e0e0e0;
      box-shadow: 0 1px 3px rgba(0,0,0,0.04);
      box-sizing: border-box;
    }

    .color-square {
      width: 80px;
      height: 80px;
      border-radius: 8px;
      border: 1px solid #ccc;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-bottom: 8px;
      background-image: linear-gradient(45deg, #ccc 25%, transparent 25%, transparent 50%, #ccc 50%, #ccc 75%, transparent 75%, transparent);
      background-size: 8px 8px;
    }

    .color-square-inner {
      width: 100%;
      height: 100%;
      border-radius: 7px;
    }

    .prop-name {
      font-family: Arial, monospace;
      font-size: 15px;
      margin-bottom: 2px;
      word-break: break-all;
    }

    .prop-value {
      font-weight: bold;
      font-family: Arial, monospace;
      font-size: 15px;
      color: #333;
      word-break: break-all;
    }

    #app {
      max-width: 1200px;
      margin: 0 auto;
    }

    .help-box {
      background: #e9f3ff;
      border: 1px solid #8dc1ff;
      color: #004c90;
      padding: 10px 14px;
      border-radius: 8px;
      margin: 10px 0;
      font-size: 14px;
    }
    
    #toggle-help-btn {
      background: #444;
      color: #fff;
      padding: 8px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      margin: 6px 0;
    }
    
    #toggle-help-btn:hover {
      background: #000;
    }
    
    #help-content {
      background: #ffffff;
      border: 1px solid #ddd;
      padding: 14px;
      border-radius: 8px;
      margin-top: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    
    #help-content pre {
      background: #f8f8f8;
      border-radius: 6px;
      padding: 10px;
      overflow-x: auto;
    }

    .debug-card {
      display:none;
      margin: 20px 0;
      padding: 16px 18px;
      background: #0f172a;              /* dark slate */
      color: #e5e7eb;                   /* light gray text */
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      box-shadow: 0 4px 12px rgba(15, 23, 42, 0.35);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    
    .debug-card h2 {
      margin: 0 0 6px;
      font-size: 1.1rem;
    }
    
    .debug-hint {
      margin: 0 0 10px;
      font-size: 0.85rem;
      color: #9ca3af;
    }
    
    #debug-output {
      margin: 0;
      padding: 10px;
      background: #020617;
      border-radius: 6px;
      font-size: 0.85rem;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      overflow-x: auto;
      white-space: pre;
    }

  </style>
</head>
<body>
  <header>
    <img src="https://putforshare.com/wp-content/uploads/2022/07/pfs-logo-svg-bg-transperant.svg" alt="Logo" />
    <div class="brand-text">
      <div class="brand-title">PutForShare.com</div>
      <div class="brand-tagline">Open Source Initiatives</div>
    </div>
    <a href="https://open.putforshare.com" class="back-btn">Back</a>

  </header>
  
  <div id="content-wrapper">
  
  <h1>PutForShare Open Source Initiative</h1>
  <!-- New Card Section -->
  <div class="color-map-card">
    <h2>Open Source initiatives</h2>
    <p>
      The PutForShare Tech Team is pleased to share the technologies and code libraries used in building our applications.
    </p>
    <h2>What is a PutForShare CSS Color finder?</h2>
    <p>
      You have color code in hex value / RGB / HSL want to see how it looks like. 
      You can use PutForShare color finder. It may be one single color code or CSS color property with value like 
    </p>
      <pre>color : #ff0023;</pre>
      <p>
      or a selector with multiple color definitions like. Simply copy paste, You can see visually
      how it looks.</p>
      <pre>
      .button {
        background-color: #2196f3;
        color: white;
      }
      </pre>
    <p> You can use any color format as follows </p>
    <pre>
      rgb(64, 64, 64),
      rgba(64, 64, 64, 1)
      hsl(0, 0%, 25%)
    </pre>
      </div>

  <div id="controls">
    <textarea id="css-input" placeholder="Write your CSS here..."></textarea>
    <br />
    <button id="render-btn">Find Colors</button>
    <button id="clear-btn" class="danger">Clear</button>

  </div>
  <div id="debug-panel" class="debug-card">
    <h2>Debug: Parsed Color Map</h2>
    <p class="debug-hint">
      This shows the final parsed list from <code>parseCssTextToColorMap(cssText)</code>.
    </p>
    <pre id="debug-output">No colors parsed yet.</pre>
  </div>
  
<!-- Quick Summary Help Box -->
<div id="quick-help" class="help-box">
  <strong>How to enter colors:</strong><br>
  1Ô∏è‚É£ Use selectors (ex: `.btn { color: red; }`)<br>
  2Ô∏è‚É£ Use prop: value (ex: `--primary: #ff0;`)<br>
  3Ô∏è‚É£ Just color values (ex: `#ff0000`)<br>
  4Ô∏è‚É£ Mix any format above
</div>

<!-- Collapsible Full Help Guide -->
<div id="help-section">
  <button id="toggle-help-btn">Show Full Help</button>
  <div id="help-content" style="display:none;">
    <h3>üìò Full Help Guide</h3>
    <p>You can enter colors using any of these formats:</p>

    <h4>1Ô∏è‚É£ Standard CSS Selector Block</h4>
    <pre><code>.button {
  background-color: #2196f3;
  color: white;
}</code></pre>

    <h4>2Ô∏è‚É£ Color Variables / CSS Properties</h4>
    <pre><code>--primary-color: #ff0000;
border-color: green;</code></pre>

    <h4>3Ô∏è‚É£ Plain Color Values</h4>
    <pre><code>#FF5733,
#33FF57,
blue</code></pre>

    <h4>4Ô∏è‚É£ Mix Any Format</h4>
    <pre><code>.card { --bg: #eee; }

--accent: purple;
#0099ff
</code></pre>

    <p><strong>Tip:</strong> Paste CSS from anywhere and instantly preview the colors!</p>
  </div>
</div>

  <div id="app"></div>
</div> <!-- end content-wrapper -->
<script>
  // --- 1. Helpers: color detection ---
  function looksLikeColor(value) {
    if (!value) return false;
    value = value.trim().toLowerCase();

    // Remove trailing semicolon if any
    value = value.replace(/;$/, '').trim();

    // Hex
    if (/^#([0-9a-f]{3}|[0-9a-f]{4}|[0-9a-f]{6}|[0-9a-f]{8})$/i.test(value)) {
      return true;
    }

    // rgb() / rgba()
    if (
      /^rgba?\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}(?:\s*,\s*(0|1|0?\.\d+))?\s*\)$/i
        .test(value)
    ) {
      return true;
    }

    // hsl() / hsla()
    if (
      /^hsla?\(\s*\d{1,3}\s*,\s*\d{1,3}%\s*,\s*\d{1,3}%(?:\s*,\s*(0|1|0?\.\d+))?\s*\)$/i
        .test(value)
    ) {
      return true;
    }

    const namedColors = new Set([
      'black','white','red','green','blue','yellow','cyan','magenta',
      'transparent','currentcolor','inherit','initial','revert','unset'
    ]);

    return namedColors.has(value);
  }

  // --- 2. Helpers for parsing text CSS ---
  function parseDeclarationsInto(text, targetArray) {
    // text is just inside block or a single line
    const declRegex = /([-\w]+)\s*:\s*([^;]+);/g;
    let m;
    while ((m = declRegex.exec(text)) !== null) {
      const propName = m[1].trim();
      const propValue = m[2].trim();
      if (looksLikeColor(propValue)) {
        targetArray.push({ name: propName, value: propValue });
      }
    }
  }

  function processBareLine(line, inlineColorsArray) {
    // Strip trailing semicolon
    let cleanLine = line.replace(/;$/, '').trim();
    if (!cleanLine) return;

    // Try the whole line as a single color first (e.g. rgb(...), #fff)
    if (looksLikeColor(cleanLine)) {
      inlineColorsArray.push({
        name: `color-${inlineColorsArray.length + 1}`,
        value: cleanLine
      });
      return;
    }

    // Else: treat as comma-separated list, but respect parentheses (rgb(..., ...))
    const parts = [];
    let current = '';
    let parenDepth = 0;

    for (const ch of line) {
      if (ch === '(') parenDepth++;
      if (ch === ')') parenDepth--;
      if (ch === ',' && parenDepth === 0) {
        if (current.trim()) parts.push(current.trim());
        current = '';
      } else {
        current += ch;
      }
    }
    if (current.trim()) parts.push(current.trim());

    for (let token of parts) {
      token = token.replace(/^["']+/, '').replace(/["']+$/, '');
      token = token.replace(/;$/, '').trim();
      if (!token) continue;

      if (looksLikeColor(token)) {
        inlineColorsArray.push({
          name: `color-${inlineColorsArray.length + 1}`,
          value: token
        });
      }
    }
  }

  // --- 3. Main parser: selectors + inline properties + bare colors ---
  function parseCssTextToColorMap(cssText) {
    const blocks = [];        // { selector, colors }
    const orphanColors = [];  // prop: value; outside selectors
    const inlineColors = [];  // bare color values / lists

    let braceDepth = 0;
    let currentSelector = null;
    let currentColors = [];

    const lines = cssText.split(/\n/);

    for (let rawLine of lines) {
      let line = rawLine.trim();
      if (!line) continue;

      // OUTSIDE any selector block
      if (braceDepth === 0) {
        // Start of a selector block?
        if (line.includes('{')) {
          const parts = line.split('{');
          const selectorPart = parts[0].trim();
          currentSelector = selectorPart || '[unnamed selector]';
          currentColors = [];
          braceDepth = 1;

          // Any declarations on the same line after '{'?
          let afterBrace = parts.slice(1).join('{'); // in case of weird things
          const closeIndex = afterBrace.indexOf('}');
          let insideText = afterBrace;

          if (closeIndex !== -1) {
            insideText = afterBrace.slice(0, closeIndex);
          }

          if (insideText.trim()) {
            parseDeclarationsInto(insideText, currentColors);
          }

          if (closeIndex !== -1) {
            // Block closes on same line
            braceDepth = 0;
            if (currentSelector && currentColors.length > 0) {
              blocks.push({ selector: currentSelector, colors: currentColors });
            }
            currentSelector = null;
            currentColors = [];
          }

          continue;
        }

        // No '{' and not inside a block ‚Üí inline stuff
        // 1) prop: value; outside selectors
        const declMatch = line.match(/^([-\w]+)\s*:\s*([^;]+);/);
        if (declMatch) {
          const propName = declMatch[1].trim();
          const propValue = declMatch[2].trim();
          if (looksLikeColor(propValue)) {
            orphanColors.push({ name: propName, value: propValue });
          }
          continue;
        }

        // 2) Bare colors or list of colors
        processBareLine(line, inlineColors);
      } else {
        // INSIDE a selector block
        const closeIndex = line.indexOf('}');

        if (closeIndex === -1) {
          // Entire line inside block
          parseDeclarationsInto(line, currentColors);
        } else {
          // Part before '}' belongs to this block
          const beforeClose = line.slice(0, closeIndex);
          if (beforeClose.trim()) {
            parseDeclarationsInto(beforeClose, currentColors);
          }

          braceDepth = 0;

          if (currentSelector && currentColors.length > 0) {
            blocks.push({ selector: currentSelector, colors: currentColors });
          }

          currentSelector = null;
          currentColors = [];
          // Ignore anything after '}' (for simplicity)
        }
      }
    }

    const result = [];

    // Selector blocks
    blocks.forEach(b => result.push(b));

    // Orphan inline properties (prop: value; outside any selector)
    if (orphanColors.length > 0) {
      result.push({
        selector: '[inline properties]',
        colors: orphanColors
      });
    }

    // Bare color values
    if (inlineColors.length > 0) {
      result.push({
        selector: '[inline colors]',
        colors: inlineColors
      });
    }

    return result;
  }

  // --- 4. Rendering the color cards from the color map ---

  function renderColorMap(colorMap, containerId = 'app') {
    const app = document.getElementById(containerId);
    if (!app) return;
    app.innerHTML = '';

    colorMap.forEach(block => {
      const selectorBlock = document.createElement('div');
      selectorBlock.className = 'selector-block';

      const title = document.createElement('div');
      title.className = 'selector-title';
      title.textContent = block.selector;
      selectorBlock.appendChild(title);

      const cardsContainer = document.createElement('div');
      cardsContainer.className = 'cards-container';

      block.colors.forEach(color => {
        const card = document.createElement('div');
        card.className = 'color-card';

        const square = document.createElement('div');
        square.className = 'color-square';

        const squareInner = document.createElement('div');
        squareInner.className = 'color-square-inner';
        squareInner.style.backgroundColor = color.value;

        square.appendChild(squareInner);

        const nameEl = document.createElement('div');
        nameEl.className = 'prop-name';
        nameEl.textContent = color.name;

        const valueEl = document.createElement('div');
        valueEl.className = 'prop-value';
        valueEl.textContent = color.value;

        card.appendChild(square);
        card.appendChild(valueEl);
        card.appendChild(nameEl);

        cardsContainer.appendChild(card);
      });

      selectorBlock.appendChild(cardsContainer);
      app.appendChild(selectorBlock);
    });
  }

  // --- 4b. Debug panel rendering ---

  function updateDebugPanel(colorMap) {
    const debugOutput = document.getElementById('debug-output');
    if (!debugOutput) return;

    if (!colorMap || colorMap.length === 0) {
      debugOutput.textContent = 'No colors parsed yet.';
      return;
    }

    const lines = [];
    colorMap.forEach(block => {
      lines.push(block.selector + ':');
      block.colors.forEach(entry => {
        lines.push(`  - ${entry.name}: ${entry.value}`);
      });
      lines.push(''); // blank line between blocks
    });

    debugOutput.textContent = lines.join('\n');
  }

  // --- 5. Use textarea value to populate `css` and render ---

  let css = '';

  function updateFromTextarea() {
    const textarea = document.getElementById('css-input');
    if (!textarea) return;
    css = textarea.value;

    const colorMap = parseCssTextToColorMap(css);
    console.log('Color map:', colorMap);

    renderColorMap(colorMap);
    updateDebugPanel(colorMap);
  }

  // Example pre-filled content
  const exampleCss = `
    .table {
      --bs-table-active-color: #212529;
      --color-default: #404040;
      --color-default-darker: #303030;
      --color-green: #6EA029;
      --color-inactive: #DC3232;
      --color-inactive-grey: #9E9E9E;
      --color-inactive-grey-light: #f1f1f1;
      --color-inactive-text: #707070;
      --color-label: #303030;
      --color-label-help: #707070;
      --color-link: #006dac;
      --color-placeholder: #707070;
    }

    --wp--preset--color--amber-100: #FEF3C7;
    --wp--preset--color--amber-200: #FDE68A;
    --wp--preset--color--amber-300: #FCD34D;
    --wp--preset--color--amber-400: #FBBF24;
    --wp--preset--color--amber-500: #F59E0B;
    --wp--preset--color--amber-600: #b37500;
    --wp--preset--color--amber-800: #92400E;
    --wp--preset--color--amber-900: #78350F;
    --wp--preset--color--black: #000000;
    --wp--preset--color--blue-100: #DBEAFE;
    --wp--preset--color--blue-500: #3B82F6;
    --wp--preset--color--blue-800: #1E40AF;
    --wp--preset--color--cyan-bluish-gray: #abb8c3;
    --wp--preset--color--default-font-color: #4B5563;
    --wp--preset--color--dimmed-font-color: #8C929F;

    --active-color: #04AE93;
    --background-color: #FFFFFF;
    --background-gradient-dark-purple: #5D237A;
    --border-color: #B2B2B2;
    --text-color: #000000;
    --title-color: #333333;

    #FF5733,
    #33FF57",
    #3357FF,
  `;

  const textareaEl = document.getElementById('css-input');
  if (textareaEl) {
    textareaEl.value = exampleCss.trim();
  }

  const renderBtn = document.getElementById('render-btn');
  if (renderBtn) {
    renderBtn.addEventListener('click', updateFromTextarea);
  }

  const toggleHelpBtn = document.getElementById('toggle-help-btn');
  if (toggleHelpBtn) {
    toggleHelpBtn.addEventListener('click', function () {
      const content = document.getElementById('help-content');
      if (!content) return;

      const isVisible = content.style.display === 'block';
      content.style.display = isVisible ? 'none' : 'block';
      this.textContent = isVisible ? 'Show Full Help' : 'Hide Full Help';
    });
  }

  // clear btn handler
  const clearBtn = document.getElementById('clear-btn');
  if (clearBtn) {
    clearBtn.addEventListener('click', () => {
      const textarea = document.getElementById('css-input');
      if (!textarea) return;
      textarea.value = '';
      renderColorMap([]);
      updateDebugPanel([]);
    });
  }

  // initial render with the example CSS
  updateFromTextarea();
</script>

</body>
</html>
